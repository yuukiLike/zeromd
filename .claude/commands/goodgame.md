---
allowed-tools: Bash, Read, Write, Edit, Glob, Grep
description: 收工总结 - 记录今天进展和下次开发计划到 todo.md
---

用户准备结束今天的开发，需要把当前状态记录到 `todo.md`，方便下次（可能是几天后）快速恢复上下文。

核心原则：此刻你的脑子里全是上下文（热状态），下一次的 Claude 是完全空白的（冷状态）。你写的内容要让一个没有任何上下文的人能在 2 分钟内理解项目当前状态并开始开发。

## 步骤

### 1. 收集项目状态

```bash
git log --since="6am" --oneline
git status --porcelain
git branch --show-current
git stash list
```

了解：今天做了什么、有无未提交变更、当前分支、有无暂存内容。

### 2. 扫描代码中的未完成标记

使用 Grep 搜索代码中的 TODO、FIXME、HACK、XXX 注释：

```
Grep(pattern: "TODO|FIXME|HACK|XXX", glob: "*.{ts,vue,rs,toml}")
```

这些是开发中留下的"路标"，必须记录。

### 3. 读取现有 todo.md

读取当前的 `todo.md`（如果存在），了解之前记录的内容，判断哪些已完成、哪些仍有效。

### 4. 与用户对话

问用户：

- 今天有什么没做完的？
- 下次想做什么？
- 有没有遇到什么坑或想法要记下来？

结合 git log、代码扫描结果和用户的回答，整理出完整的记录。

### 5. 写入 todo.md

用 Write 工具覆盖 `todo.md`，格式如下：

```markdown
# Todo

> 更新于 YYYY-MM-DD

## 当前状态
- 分支：<当前分支>
- 未提交变更：有/无
- 最近完成：<今天的主要 commit 摘要>

## 进行中
- [ ] <正在做但没完成的功能，写清楚做到哪一步了，下一步是什么>

## 下次要做
- [ ] <具体任务，按优先级排列>

## 代码中的 TODO
- `<file>:<line>` — <TODO 内容>

## 备忘
- <踩坑记录、设计想法、待讨论的技术决策等>
```

**写作要求：**
- 每条都要有足够上下文，假设读的人完全不知道你在做什么
- "进行中"要写清楚当前进度和卡在哪里，不能只写一个标题
- 涉及具体文件时标注文件路径

### 6. 输出

```
😴 收工记录已保存到 todo.md
📋 下次开发时用 /join 查看
```
